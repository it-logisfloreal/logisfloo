<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record model="ir.ui.view" id="logisfloo_view_purchase_order_filter">
        <field name="name">logisfloo.view.purchase.order.filter</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.view_purchase_order_filter" />
        <field name="arch" type="xml">
        	<filter name="not_invoiced" position = "before">
        		<filter name="deposite" string="Deposite" domain="[('state','=','deposite')]"/>
        	</filter>
        </field>
    </record>

    <record model="ir.ui.view" id="logisfloo_purchase_order_form_view">
        <field name="name">logisfloo.purchase.order.form.view</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form" />
        <field name="arch" type="xml">
        	<xpath expr="//div[@name='button_box']" position="attributes">
    			<attribute name="attrs">{'invisible': [('state', 'not in', ('purchase', 'done', 'cancel','deposite'))]}</attribute>
			</xpath>
        	<xpath expr="//field[@name='state']" position="attributes">
    			<attribute name="statusbar_visible">draft,purchase,done</attribute>
			</xpath>
        	<button name="button_done" position = "before">
        		<button name="button_deposite" type="object" string="Deposite" states="purchase" class="oe_highlight"
                        help="Purchase in deposite."/>
        		<button name="button_undo" type="object" string="Undo" states="deposite,done" class="oe_highlight"
                        help="Reopen the purchase order."/>
        	</button>
        	<field name="order_line" position="replace">
                <field name="order_line">
                     <tree string="Purchase Order Lines" editable="bottom">
                         <field name="product_id" context="{'partner_id': parent.partner_id}"/>
                         <field name="name"/>
                         <field name="date_planned"/>
                         <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                         <field name="account_analytic_id" context="{'default_partner_id':parent.partner_id}" groups="purchase.group_analytic_accounting"/>
                         <field name="product_qty"/>
                         <field name="qty_received" invisible="not context.get('show_purchase', False)"/>
                         <field name="qty_invoiced" invisible="not context.get('show_purchase', False)"/>
                         <field name="product_uom" groups="product.group_uom"/>
                         <field name="price_unit"/>
                         <field name="discount" string="Discount (%)"/>
                         <field name="taxes_id" widget="many2many_tags" domain="[('type_tax_use','=','purchase')]" context="{'default_type_tax_use': 'purchase'}"/>
                         <field name="price_subtotal" widget="monetary"/>
                     </tree>
                     <form string="Purchase Order Line">
                         <sheet>
                             <group>
                                 <group>
                                     <field name="product_id"
                                            context="{'partner_id': parent.partner_id}"/>
                                     <label for="product_qty"/>
                                     <div>
                                         <field name="product_qty" class="oe_inline"/>
                                         <span class="oe_inline">&#160;</span>
                                         <field name="product_uom" groups="product.group_uom" class="oe_inline"/>
                                     </div>
                                     <field name="price_unit"/>
                                 </group>
                                 <group>
                                     <label for="discount"/>
                                     <div>
                                     	<field name="discount" class="oe_inline"/> %
                                     </div>
                                     <field name="taxes_id" widget="many2many_tags" domain="[('type_tax_use', '=', 'purchase')]"/>
                                     <field name="date_planned" widget="date"/>
                                     <field name="account_analytic_id" colspan="2" groups="purchase.group_analytic_accounting"/>
                                     <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                 </group>
                             </group>
                             <notebook>
                             <page string="Notes">
                                 <field name="name"/>
                             </page><page string="Invoices and Incoming Shipments">
                                 <field name="invoice_lines"/>
                                 <field name="move_ids"/>
                             </page>
                             </notebook>
                         </sheet>
                     </form>
                 </field>
			</field>        	

        </field>
    </record>

<!-- Put mostly used items under a simplified menu option (creating the menu first) -->

    <menuitem id="logisfloo_simplified_menu"
                parent="base.menu_purchase_root"                
                name="Simplified Menu"
                sequence="2"  />

	<menuitem id="logisfloo_menu_purchase_rfq"
		action="purchase.purchase_rfq" 		
		parent="logisfloo_simplified_menu"
		sequence="0"/>

    <menuitem id="logisfloo_menu_purchase_form_action" 
    	action="purchase.purchase_form_action"     	
    	parent="logisfloo_simplified_menu" 
    	sequence="6"/>

	<menuitem id="logisfloo_menu_procurement_partner_contact_form" 
		name="Products" 		
		action="purchase.product_normal_action_puchased"
		parent="logisfloo_simplified_menu" 
		sequence="20"/>

<!-- move other menu item under an advanced option menu (creating the menu first) -->

    <menuitem id="logisfloo_advanced_menu"
                parent="base.menu_purchase_root"                
                name="Advanced Menu"
                sequence="3"  
                groups="group_logisfloo_purchase_advanced" />

	<record model="ir.ui.menu" id="purchase.menu_procurement_management">
		<field name="parent_id" ref="logisfloo_advanced_menu"/>
	</record>
	
	<record model="ir.ui.menu" id="purchase.menu_purchase_config">
		<field name="parent_id" ref="logisfloo_advanced_menu"/>
	</record>

	<record model="ir.ui.menu" id="purchase.menu_purchase_control">
		<field name="parent_id" ref="logisfloo_advanced_menu"/>
	</record>

</odoo>